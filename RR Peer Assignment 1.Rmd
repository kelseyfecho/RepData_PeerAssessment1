---
title: "RR Peer Assignment 1"
author: "Kelsey Fecho"
date: "Thursday, February 12, 2015"
output: html_document
---
##Introduction##
This assignment analyzes data from personal activity monitoring devices. It is required that the document be in R markdown that can be processed by knitr and transformed into an HTML file.

##Load the Data##
###Working Directory###
First, we need set the working directory to the folder where out data set is saved. To do so, save the folder location into the dir variable, and call the setwd argument as below. 
```{r}
dir <- c("C:/Users/kfecho/Documents/Training/Coursera/Reproducible Research")
setwd(dir)
```

###Read in the File###
Now that the program knows where to look, use read.csv to load the data set into R. We'll also save the file into a variable called "activity" so we can use it easily later.
```{r}
activity <- read.csv(file="activity.csv", header=TRUE)
```

##Mean Number of Steps Daily##
###Remove NA Values###
For this part of the assignment, we will need data that does not include any missing values, entered as "NA". Let's create a subset of only complete rows with the na.omit function.
```{r}
complete <- na.omit(activity)
```

###Aggregate Daily Steps###
This steps aggregates the number of steps for each day of the recorded data. The data covers 53 days, so let's add a check at the end to make sure we have 53 records.
```{r}
dailysteps <- aggregate(steps ~ date, data=complete, sum)
dim(dailysteps)
```

###Construct a Histogram###
Constructing a histogram using R is fairly straight-forward. Now that we have the data aggregated as necessary, simply call the desired data, in this case steps, into the hist() function.
```{r}
hist(dailysteps$steps, col="peachpuff", main="Total Steps Per Day", xlab="# of Steps", ylab="# of Days")
```

###Calculate the Mean and Median###
Mean and Median are easy calculations to make in R, and are a good way to exploratorily analyze data quickly.
```{r}
mean(dailysteps$steps)
median(dailysteps$steps)
```

##Average Daily Activity Pattern##
For this first part, let's continue to ignore NA values--we'll come back to them later.

```{r}
plot(complete$interval, complete$steps, type = "l", col="cornflowerblue", main = "Average Daily Activity Pattern", xlab="Intervals", ylab="Steps")
```

While we're at it, let's figure out which **specific interval had the most activity averaged over all days**. First, we figure out what the maximum average number of steps are. In this case, it's 806 steps. Then, we subset the data to show us the rest of the entry for when steps = 806. We then see that interval 615 has the most average number of steps.

```{r}
max(complete$steps)
most <- complete[complete$steps=="806",]
most
```

##Imputing Missing Values##
Let's start back with our original data set, "activity", for this new task. We'll need to figure out how to populate NA values logically. First, let's **calculate the numbers of rows containing "NA"** in the original data set.
```{r}
missing <- activity[activity$step == "NA",]
dim(missing)
```
Now we can see that we have properly subsetted the rows with missing values, and that there were 2304 such rows. Our strategy for populating these missing values will be to replace them with the mean number of steps for their particular day. I've calculated the mean by using the "complete"" data set from before, which excludes NA values from calculation.
```{r}
meansteps <- aggregate(steps~interval, data=complete,mean)
head(meansteps)
dim(meansteps)
```

Now, I will merge the original data set with the mean steps data set by interval and check my output with the head() function.

```{r}
merge <- merge(activity, meansteps, by="interval")
head(merge)
```

Now that we have both NA values and intended values in the same data set, I will use a for loop to move mean values to the step column only when the step column equals "NA". Again, I will use head() to check my output. Only the rows that were originally "NA" should have new values.

```{r}
nrow(merge)
for (i in 1:nrow(merge)){
  if(is.na(merge[i,2])){merge[i,2]=merge[i,4]}
}
head(merge)
```
Because only the first row in the head section has changed, our code has worked. Now, we need to trim out the extra column by simply subsetting.

```{r}
final <- merge[,1:3]
head(final)
```

Repeating aggregation logic from before, we need to aggregate the number of steps per day now that all NA values have been imputed with new values, make a histogram, and calculate the mean and median of our new data.
```{r}
finaldailysteps <- aggregate(steps.x~date, data=final, sum)
hist(finaldailysteps$steps.x, col="peachpuff", main="Total Steps Per Day", xlab="# of Steps", ylab="# of Days")
mean(finaldailysteps$steps.x)
median(finaldailysteps$steps.x)
```
We can see now that the mean has not changed from before. This is because we used interval **means** to impute NA values. However, the median has now increased slightly and is now equal with the mean. This is because by filling in values greater than 0 where none have previously existed increased the number of total steps. It is only logical, then, that the middle number of that data set should increase.

##Weekdays vs. Weekends##
